# 服务器配置
PORT=3000
SESSION_SECRET=change-me-to-random-string

# NodeLoc OAuth
NODELOC_URL=https://www.nodeloc.com
NODELOC_CLIENT_ID=your-client-id
NODELOC_CLIENT_SECRET=your-client-secret
NODELOC_REDIRECT_URI=http://localhost:3000/auth/callback

# 白名单模式（true/false）
WHITELIST_ENABLED=false

# 反向代理信任策略
# TRUST_PROXY: 兼容 Express 写法（默认 1，表示信任一层反代）
TRUST_PROXY=1
# TRUST_PROXY_CIDRS: 开启后优先于 TRUST_PROXY，仅信任这些来源的反代头（逗号分隔，支持 IP/CIDR）
# 例如：127.0.0.1/32,10.0.0.0/8,::1/128
TRUST_PROXY_CIDRS=

# 订阅反爬风控（off|observe|enforce）
SUB_CLIENT_FILTER_MODE=off
# 客户端 UA 白名单（逗号分隔，支持正则）
SUB_UA_ALLOWLIST=clash,clash-meta,mihomo,stash,sing-box,singbox,sfa,sfi,v2rayn,v2rayng,shadowrocket,quantumult,surfboard,nekoray
# 单 token 速率限制（窗口毫秒/窗口内最大请求/封禁时长毫秒）
SUB_TOKEN_WINDOW_MS=60000
SUB_TOKEN_MAX_REQ=20
SUB_TOKEN_BAN_MS=900000
# 异常行为判定窗口（窗口内 token 可见 IP/UA 上限）
SUB_BEHAVIOR_WINDOW_MS=120000
SUB_BEHAVIOR_MAX_IPS=6
SUB_BEHAVIOR_MAX_UAS=4

# AI API Keys（第二阶段）
GEMINI_API_KEY=
CLAUDE_API_KEY=
